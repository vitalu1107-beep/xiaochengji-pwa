<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#46B256" />
  <title>小成就 · Small Wins</title>

  <!-- PWA -->
  <link rel="manifest" href="./manifest.json" />
  <link rel="apple-touch-icon" href="./icons/icon-192.png" />
  <link rel="icon" href="./icons/icon-192.png" />

  <!-- Styles -->
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <div class="app">
    <div class="container">
      <!-- 顶部品牌 -->
      <header>
        <div class="brand">
          <img class="logo" src="./icons/icon-192.png" alt="logo" />
          <div class="titles">
            <h1>小成就 <span class="muted brand-en">Small Wins</span></h1>
            <p class="muted">记录每天的小小进步。</p>
          </div>
        </div>

        <!-- 顶部导航（桌面保留；移动端在 CSS 隐藏） -->
        <nav class="topnav" aria-label="主导航">
          <button id="tab-home" class="active" type="button" data-target="page-home">首页</button>
          <button id="tab-today" type="button" data-target="page-today">记录微光</button>
          <button id="tab-wall" type="button" data-target="page-wall">成就墙</button>
          <button id="tab-random" type="button" data-target="page-random">随机回顾</button>
          <button id="tab-settings" type="button" data-target="page-settings">设置</button>
        </nav>
      </header>

      <!-- ========== 页面：首页 ========== -->
      <main id="page-home">
        <!-- 问候 -->
        <section class="panel">
          <div class="muted" id="home-date">—</div>
          <div class="home-greeting" id="home-greeting">晚上好，夏央</div>
        </section>

        <!-- 今日能量 -->
        <section class="panel">
          <div class="muted small" style="margin-bottom:8px;">今日能量</div>
          <div id="home-quote" class="home-quote">
            “你不需要很厉害才开始，你需要开始才会变厉害。”
          </div>
        </section>

        <!-- 两张卡：横排 -->
        <section class="stats-grid" aria-label="统计卡片">
          <div class="stat-card" id="card-achievement">
            <div class="stat-top">
              <h3>🏆 成就记录</h3>
            </div>

            <div class="stat-mid">
              <div class="big" id="stat-streak">0</div>
              <p class="sub muted" id="stat-streak-sub">已坚持 0 天</p>
            </div>

            <div class="stat-actions">
              <button class="btn btn-soft" type="button" data-target="page-today">去记录</button>
            </div>
          </div>

          <div class="stat-card" id="card-happy">
            <div class="stat-top">
              <h3>💗 小确幸墙</h3>
            </div>

            <div class="stat-mid">
              <div class="big" id="stat-happy">0</div>
              <p class="sub muted" id="stat-happy-sub">0 个瞬间</p>
            </div>

            <div class="stat-actions">
              <button class="btn btn-soft" type="button" data-target="page-wall">去看看</button>
            </div>
          </div>
        </section>

        <!-- 最近的小快乐 -->
        <section class="panel">
          <h2 class="section-title">最近的小快乐</h2>
          <div id="recent-list" class="list">
            <div class="muted" id="recent-empty">还没有记录～先写下第一件小小进步吧 ✨</div>
          </div>
        </section>
      </main>

      <!-- ========== 页面：记录微光 ========== -->
      <main id="page-today" style="display:none;">
        <section class="panel">
          <h2 class="section-title">✨ 记录微光</h2>

          <div class="record-wrap">
            <!-- 输入改为 textarea（更大） -->
            <textarea
              id="input-text"
              class="record-input"
              placeholder="比如：今天我完成了一个小目标 / 我把一件事推进了一步"
              autocomplete="off"
              rows="4"
            ></textarea>

            <div id="tag-suggest" class="tag-suggest" style="display:none;"></div>

            <!-- 选择心情 -->
            <div class="mood-title" id="mood-title">选择心情</div>

            <div class="mood-grid" id="mood-group" role="group" aria-label="选择心情">
              <button class="mood-btn" type="button" data-mood="calm">🌙 平静</button>
              <button class="mood-btn" type="button" data-mood="happy">✨ 愉悦</button>
              <button class="mood-btn" type="button" data-mood="relaxed">🌱 释然</button>
              <button class="mood-btn" type="button" data-mood="lazy">☁️ 慵懒</button>
            </div>

            <!-- 保存按钮 -->
            <button id="btn-save" class="primary-btn" type="button">封存这一刻</button>

            <div class="muted small hint">
              小提示：长按下面的某条记录可以删除；想换行直接回车；快捷保存用 Ctrl/⌘ + Enter。
            </div>
          </div>
        </section>

        <!-- 今日列表 -->
        <section class="panel">
          <div class="panel-head-row">
            <h2 class="section-title" style="margin:0;">📅 今天</h2>
            <button id="btn-clear-today" class="btn" type="button">清空今天</button>
          </div>

          <div id="today-list" class="list"></div>
          <div id="today-empty" class="muted" style="text-align:center;padding:18px 0;">今天还没有记录～</div>
        </section>
      </main>

      <!-- ========== 页面：成就墙（全览+搜索） ========== -->
      <main id="page-wall" style="display:none;">
        <!-- 搜索面板（方案 A：不放固定标签行） -->
        <section class="panel">
          <h2 class="section-title">🧱 成就墙（全览 + 搜索）</h2>

          <div class="search-row">
            <input id="wall-search" class="input" type="text" placeholder="搜索：比如 #运动 / #工作 / 阅读 / 复盘" />
            <button id="btn-wall-clear-search" class="btn" type="button">清空搜索</button>
          </div>

          <div class="muted small" style="margin-top:10px;">
            小提示：输入 <b>#</b> 会出现你记录过的标签联想（比如 #工作）。
          </div>
        </section>

        <!-- 全部记录面板 -->
        <section class="panel">
          <div class="panel-head-row">
            <h2 class="section-title" style="margin:0;">全部记录</h2>
            <button id="btn-wall-clear-all" class="btn danger" type="button">清空全部</button>
          </div>

          <div id="wall-list" class="list"></div>
          <div id="wall-empty" class="muted" style="text-align:center;padding:18px 0;">还没有记录～</div>

          <div class="muted small hint" style="margin-top:10px;">
            小提示：长按某条记录可删除（不会影响点击查看全文）。
          </div>
        </section>
      </main>

      <!-- ========== 页面：随机回顾 ========== -->
      <main id="page-random" style="display:none;">
        <section class="panel">
          <h2 class="section-title">🎲 随机回顾</h2>
          <div id="random-card" class="panel" style="background:rgba(255,255,255,.65);">
            <div class="muted" style="margin-bottom:8px;">你抽到的是：</div>
            <div id="random-text" style="font-size:18px;font-weight:800;line-height:1.4;">—</div>
            <div id="random-time" class="muted small" style="margin-top:10px;">—</div>
            <div style="display:flex;gap:10px;margin-top:12px;flex-wrap:wrap;">
              <button id="btn-random-next" class="btn" type="button">再来一条</button>
              <!-- ✅ 不再显示删除按钮 -->
            </div>
          </div>
        </section>
      </main>

      <!-- ========== 页面：设置 ========== -->
      <main id="page-settings" style="display:none;">
        <section class="panel">
          <h2 class="section-title">⚙️ 设置</h2>
          <p class="muted small" style="margin-top:0;">
            这是一个离线友好的 PWA 原型。数据保存在本地浏览器（localStorage），不会上传服务器。
          </p>

          <div style="margin-top:14px;">
            <button id="btn-install" class="btn" type="button">安装到手机（添加到桌面）</button>
            <div class="small muted" id="install-tip" style="margin-top:8px;">✅ 可安装：点击上方按钮即可添加到桌面。</div>
          </div>

          <hr class="hr" />

          <!-- 昵称 -->
          <div style="margin-top:6px;">
            <div style="font-weight:800;margin-bottom:8px;">昵称（用于首页问候语）</div>
            <div class="form-row">
              <input id="nickname-input" class="input" type="text" placeholder="比如：夏央" />
              <button id="btn-save-nickname" class="btn" type="button">保存昵称</button>
            </div>
            <div class="muted small" style="margin-top:8px;">
              保存后首页会显示：<span id="nickname-preview">晚上好，夏央</span>
            </div>
          </div>

          <hr class="hr" />

          <!-- 导出 / 清空 -->
          <div style="display:flex;gap:10px;flex-wrap:wrap;">
            <button id="btn-export" class="btn" type="button">导出为文本（复制）</button>
            <button id="btn-clear-all" class="btn danger" type="button">清空全部数据</button>
          </div>
        </section>
      </main>

    </div>
  </div>

  <!-- ========== 底部 Tab Bar（移动端使用） ========== -->
  <nav class="tabbar" id="tabbar" aria-label="底部导航">
    <button class="tabbar-btn active" type="button" data-target="page-home" aria-label="首页">
      <span class="ico">🏠</span><span class="txt">首页</span>
    </button>
    <button class="tabbar-btn" type="button" data-target="page-today" aria-label="记录微光">
      <span class="ico">✍️</span><span class="txt">记录</span>
    </button>
    <button class="tabbar-btn" type="button" data-target="page-wall" aria-label="成就墙">
      <span class="ico">🧱</span><span class="txt">成就墙</span>
    </button>
    <button class="tabbar-btn" type="button" data-target="page-random" aria-label="随机回顾">
      <span class="ico">🎲</span><span class="txt">回顾</span>
    </button>
    <button class="tabbar-btn" type="button" data-target="page-settings" aria-label="设置">
      <span class="ico">⚙️</span><span class="txt">设置</span>
    </button>
  </nav>

  <!-- ========== Modal：点列表看全文（main.js 会控制显示/隐藏） ========== -->
  <div id="modal" class="modal" style="display:none;" aria-hidden="true">
    <div class="modal-backdrop" data-close="1"></div>
    <div class="modal-card" role="dialog" aria-modal="true">
      <div class="modal-title" id="modal-title"></div>
      <div class="modal-body" id="modal-body"></div>
      <button class="btn" type="button" data-close="1">关闭</button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="./main.js" defer></script>

  <!-- Service Worker -->
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./sw.js").catch(() => {});
      });
    }
  </script>
</body>
</html>
